<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]>      <html class="no-js"> <!--<![endif]-->
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>user_profile page</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.4/font/bootstrap-icons.css" />
    <style>
        a {
            color: white;
            background-color: transparent;
            text-decoration: none;
        }

        .container {
            margin-left: 10px;
            margin-bottom: 10px;
        }

        .btn {
            font-size: 12px;
        }

        .col-form-label {
            margin: 2%;
        }

        .form-control {
            margin: 2%;
        }

        .error {
            margin-left:2%;
            color: red;
        }

        form label {
            padding-left: 2%;
            padding-bottom:5px;
            padding-top:2px;
        }
    </style>
</head>

<body>
    <navbar> </navbar>
    <div class="row" style="
        margin: 5px;
        height: 25%;
        background-color: rgb(0, 75, 135);
        color: white;
      ">
        <div class="col col-md-11 col-sm-11">welcome <%= result.first_name %>
        </div>
        <div class="col col-md-1 col-sm-1">
            <a href="/account">Log out</a>
        </div>
    </div>
    <div class="row">
        <div class="col col-md-3">
            <div class="container" style="border: 2px solid black; text-align: center">
                <% let sometime=result;sometime.new="adding" %>
                    <% const params=new URLSearchParams(sometime).toString(); %>

                        <!-- // Encode the data as a URL query string -->
                        <a href="/user_profile/myprofile/?<%=params %>">

                            <div>
                                <i class="bi bi-person-fill" style="font-size: 4rem; color:black;"></i>
                            </div>
                            <div>
                                <button type="button" class="btn"
                                    style="background-color: rgb(10, 131, 195); color: white">
                                    MY PROFILE
                                </button>
                            </div>
                        </a>
            </div>
            <div class="container" style="border: 2px solid black; text-align: center">
                <a href="/user_profile/change_password/?<%= params %>">

                    <div>
                        <i class="bi bi-lock" style="font-size: 4rem; color:black;"></i>
                    </div>
                    <div>
                        <button type="button" class="btn" style="background-color: rgb(10, 131, 195); color: white">
                            CHANGE PASSWORD
                        </button>
                    </div>
                </a>
            </div>

            <div class="container" style="border: 2px solid black; text-align: center">
                <a href="/user_profile/buy_ticket/?<%=params %>">

                    <div>
                        <i class="bi bi-ticket-detailed" style="font-size: 4rem; color:black;"></i>
                    </div>
                    <div>
                        <button type="button" class="btn" style="background-color: rgb(10, 131, 195); color: white">
                            BUY TICKET
                        </button>
                    </div>
                </a>
            </div>
            <div class="container" style="border: 2px solid black; text-align: center">
                <a href="/user_profile/transactions/?<%=params %>">

                    <div>
                        <i class="bi bi-card-checklist" style="font-size: 4rem ;color:black;"></i>
                    </div>
                    <div>
                        <button type="button" class="btn" style="background-color: rgb(10, 131, 195); color: white">
                            Transaction History
                        </button>
                    </div>
                </a>
            </div>
        </div>
        <div class="col-md-9 col  col-sm-12">

            <div class="container" style=" border:2px solid black; width:95%; padding:0px">
                <div style="background-color: rgb(10, 131, 195);
    color: white; height:10%;"> Ticket Booking
                </div>
                <form id="booking_form">
                    <div class="form-group ">
                        <label for="from">From</label>
                        <select class="form-control w-50 form-select" id="from" placeholder="From">
                            <option value="none">Please Select</option>

                            <option value="1">Miyapur</option>
                            <option value="2">JNTU College</option>
                            <option value="3">KPHB Colony</option>
                            <option value="4">Kukatpally</option>
                            <option value="5">Balanagar</option>
                            <option value="6">Moosapet</option>
                            <option value="7">Bharat Nagar</option>
                            <option value="8">Erragadda</option>
                            <option value="9">ESI Hospital</option>
                            <option value="10">S.R. Nagar</option>
                            <option value="11">Ameerpet</option>
                            <option value="12">Madhura Nagar</option>
                            <option value="13">Yusufguda</option>
                            <option value="14">Road No 5 Jubilee Hills</option>
                            <option value="15">Jubilee check post</option>




                        </select>
                        <div class="error"></div>

                    </div>

                    <div class="form-group ">
                        <label for="To">To</label>
                        <select class="form-control w-50 form-select" id="To" placeholder="To">
                            <option value="none">Please Select</option>

                            <option value="1">Miyapur</option>
                            <option value="2">JNTU College</option>
                            <option value="3">KPHB Colony</option>
                            <option value="4">Kukatpally</option>
                            <option value="5">Balanagar</option>
                            <option value="6">Moosapet</option>
                            <option value="7">Bharat Nagar</option>
                            <option value="8">Erragadda</option>
                            <option value="9">ESI Hospital</option>
                            <option value="10">S.R. Nagar</option>
                            <option value="11">Ameerpet</option>
                            <option value="12">Madhura Nagar</option>
                            <option value="13">Yusufguda</option>
                            <option value="14">Road No 5 Jubilee Hills</option>
                            <option value="15">Jubilee check post</option>
                        </select>
                        <div class="error"></div>
                    </div>

                    <div class="form-group">
                        <label class="control-label" for="date">Date</label>
                        <input class="form-control w-50 form-select" id="date" name="date" placeholder="MM/DD/YYY"
                            type="text">
                        <div class="error"></div>

                    </div>


                    <div class="form-group row">
                        <div class="col-md-2" style="margin:2%;">
                            <input type="submit" class="form-control"
                                style="background-color: rgb(7,131,195); color:white;" id="submit_password" value="Book"
                                name="button">
                        </div>
                    </div>

                </form>

            </div>
        </div>
        <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

        <!-- Include Date Range Picker -->
        <script type="text/javascript"
            src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/js/bootstrap-datepicker.min.js"></script>
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.4.1/css/bootstrap-datepicker3.css" />

        <script>
            $(document).ready(function () {
                var date_input = $('input[name="date"]'); //our date input has the name "date"
                var container = $('.bootstrap-iso form').length > 0 ? $('.bootstrap-iso form').parent() : "body";
                date_input.datepicker({
                    format: 'mm/dd/yyyy',
                    startDate: 'mm/dd/yyyy',
                    endDate: '+1d',
                    container: container,
                    todayHighlight: true,
                    autoclose: true,
                })
            })
        </script>
        <% let something=result %>

            <script>
                const from = document.getElementById("from");
                const to = document.getElementById("To");
                const date = document.getElementById("date");

                const ticket_form = document.getElementById("booking_form");
                ticket_form.addEventListener("submit", (e) => {
                    e.preventDefault();
                    validateInputs();

                    // const data = {
                    //         email: something.email,
                    //         first_name: something.first_name,
                    //         last_name:something.last_name,
                    //         mobile_number:something.mobile_number,

                    //     };

                    //     // Encode the data as a URL query string
                    //     const params = new URLSearchParams(data).toString();
                    //    window.location.assign(`/user_profile/book/?${params}`);
                });
                let something= <%- JSON.stringify(something) %>;

                const validateInputs = () => {
                    const from_value = from.value.trim();
                    const to_value = to.value.trim();
                    const date_value = date.value.trim();
                    if (from_value == "none") {
                        SetError(from, "please select from value");
                    }
                    else if (to_value == "none") {
                        SetError(to, "please select to value");
                    }
                    else if(to_value == from_value) {
                        SetError(to, "destination should be different");

                    }
                    else if (date_value == "") {
                        SetError(date, "please select date value");
                      
                    }
                    else{
                         const data = {
                            id:something.id,
                            email: something.email,
                            first_name: something.first_name,
                            last_name:something.last_name,
                            mobile_number:something.mobile_number,
                            from:from_value,
                            to:to_value,
                            date:date_value,
                            new:"reserverd"

                        };

                        // Encode the data as a URL query string
                        const params = new URLSearchParams(data).toString();
                       window.location.assign(`/user_profile/book/?${params}`);

                    }


                }
                const SetError = (element, message) => {
                    const inputControl = element.parentElement;
                    const errorDisplay = inputControl.querySelector(".error");

                    errorDisplay.innerText = message;
                    // inputControl.classList.add("error");
                };
            </script>
</body>

</html>